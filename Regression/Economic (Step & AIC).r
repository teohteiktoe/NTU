### AB1202: Statistics and Analysis
### Nanyang Technological University
### Nanyang Business School
### Author: Chin Chee Kai
### Date:   2017 Jul 28
### Date:   2018 Jan 02 (Update)
### Date:   2018 Jul 30 (Update)
###
### Tutorial 10
###
### Purpose: Q4 Data File for Students
### Credit:  Data source originally from The World Bank data on Kenya,  
###       http://data.worldbank.org/country/kenya
### Distributable: Yes
###


datatext = "
Y	X1	X2	X3	X4	X5	X6	X7	X8	X9	X10
0.1311558	0.13783468	0.126550186	0.1060028	0.10597768	0.1129646	0.0816488	0.08162368	1.392681487	1.361602265	1.411604583
0.14828378	0.15604281	0.142539044	0.1185496	0.11830601	0.12670398	0.0912568	0.09101321	1.487237634	1.453941179	1.493837949
0.1704041	0.182486293	0.16538163	0.1481522	0.140120294	0.1465725	0.117383	0.109351094	1.554731074	1.509348539	1.578435091
0.19643361	0.207504022	0.188052428	0.159174288	0.160037622	0.16845481	0.122554288	0.123417622	1.570759691	1.534903242	1.62574399
0.224230069	0.227625887	0.213954397	0.180024729	0.180603687	0.193788069	0.142418329	0.142997287	1.590067759	1.579970823	1.641703934
0.264471873	0.265556529	0.253051281	0.219476013	0.220805669	0.228050473	0.178000813	0.179330469	1.574356607	1.571497513	1.632077683
0.333611292	0.317101607	0.3127207	0.258902152	0.258351207	0.283708212	0.210595352	0.210044407	1.54509021	1.581351844	1.603998214
0.400657837	0.389381577	0.380349386	0.310795547	0.312081687	0.338064737	0.250076147	0.251362287	1.636585191	1.660486025	1.66534102
0.46525074	0.495782072	0.448785223	0.39129754	0.394265472	0.3937664	0.32224074	0.325208672	1.795574796	1.738339412	1.76820455
0.687998	0.735544901	0.675095721	0.627799	0.632318901	0.615332	0.523357	0.527876901	1.860549954	1.785717125	1.870999113
0.770313	0.837209617	0.760199691	0.714201	0.720576617	0.690269	0.594524	0.600899617	1.947887375	1.841472729	1.889145583
0.8508082	0.923626494	0.842966137	0.799283	0.781603494	0.755827	0.661027	0.643347494	2.04586711	1.925983616	1.958236292
0.90692763	0.966121024	0.894770855	0.855535	0.825353024	0.804994	0.712664	0.682482024	2.054637412	1.960062554	1.995298506
0.96783693	1.065916577	0.957950861	0.903428	0.897376577	0.858918	0.757727	0.751675577	2.070244362	1.941164001	2.014072003
1.020221	1.123096855	1.008632958	0.974752	0.931393855	0.906873	0.811793	0.768434855	2.212525221	2.065090921	2.087300043
1.035373	1.09104218	1.025798216	0.990774	0.93430518	0.918913	0.813953	0.75748418	2.142525322	2.066470879	2.102865773
1.131782	1.199220762	1.119170974	1.078028	1.012678762	1.006061	0.872821	0.807471762	2.175098297	2.090221896	2.161012209
1.274329	1.354057218	1.263118985	1.190029	1.137899218	1.132851	0.962433	0.910303218	2.284183684	2.192697299	2.276447268
1.415725	1.521349492	1.415257	1.313504	1.271478492	1.261528	1.067448	1.025422492	2.445453087	2.330871748	2.430184483
1.862041	2.034589	1.856988	1.686614	1.687624	1.649996	1.419467	1.420477	2.723607	2.524701439	2.581514791
2.151349	2.367706	2.141643	1.925119	1.927605	1.903472	1.610385	1.612871	2.897128	2.669807074	2.753718726
2.483058	2.786748	2.480868	2.259621	2.299753	2.211447	1.870427	1.910559	2.981638	2.696105628	2.769675843
2.863688	3.17292	2.860234	2.619294	2.619294	2.558792	2.183599	2.183599	3.17292	2.863688	2.860234
3.169301	3.578554	3.157604	2.894169	2.921403	2.827436	2.445293	2.472527	3.435004	3.067834426	3.093075213
3.725918	4.366654	3.726538	3.458413	3.558027	3.347996	2.936351	3.035965	3.693634	3.214844741	3.294549595
4.26137	4.828574	4.234686	3.94565	3.913419	3.830036	3.355112	3.322881	3.853936	3.428044785	3.42304191
4.745143	5.375396	4.693472	4.502389	4.421369	4.263963	3.831453	3.750433	4.067148	3.614353106	3.607761779
5.40241	6.196834	5.326072	5.066989	4.98493	4.88253	4.316539	4.23448	4.338272	3.781508407	3.788589386
6.260646	6.953567	6.193485	5.847953	5.602244	5.708251	4.9531	4.707391	4.526062	4.021093747	4.017827048
7.158695	7.787929	7.08928	6.690651	6.555902	6.557064	5.714141	5.579392	4.699286	4.245806646	4.257201943
"

d<-read.delim(textConnection(datatext),header=TRUE,sep="",strip.white=TRUE)

# Stepwise forward with full model
# model_forward
# You save the stepwise-forward regression model result in variable model_forward.
# Use the formula step()
# Use summary(model_forward) to display the result
model_null = lm(d$Y ~ 1)
model_full = lm(d$Y ~ d$X1+d$X2+d$X3+d$X4+d$X5+d$X6+d$X7+d$X8+d$X9+d$X10)
model <- step(model_null, formula(model_full), direction="forward")
summary(model)
### model_back <- step(model_full, formula(model_null), direction="backward")


# Stepwise backward with subset model
# model_subback
# You save the stepwise-forward regression model result in variable model_subback
# Use the formula step()  Remember to ensure the "backward" direction is specified
# and the order of stepping back from which model to which model is clearly specified.
sub_formula = "d$Y ~ d$X1 + d$X3 + d$X4 + d$X6 + d$X8 + d$X10"
model_sub = lm(sub_formula)
model_subback <- step(model_sub, model_null, direction="backward",
                      trace=TRUE)
summary(model_subback) ## Display it on screen

#sub_formula = "d$Y ~ d$X1 + d$X3 + d$X4 + d$X6 + d$X8 + d$X10"
#model_sub = lm(sub_formula)

# Use summary(model_subback) to display the result
#summary(model_sub)
