### AB1202: Statistics and Analysis
### Nanyang Technological University
### Nanyang Business School
### Author: Chin Chee Kai
### Date:   2017 Jul 28
### Date:   2018 Jan 02 (Update)
### Date:   2018 Jul 30 (Update)
###
### Tutorial 10
###
### Purpose: Q1 Data File for students
### Credit:  Data source originally from Yahoo Finance 
###       http://finance.yahoo.com/
###     and Exchange-Rates.org
###       http://www.exchange-rates.org/history/SGD/USD/T
### Distributable: Yes
###


datatext = "
Date	     DBS     	SGD
2017-06-20	20.45	1.38925
2017-06-19	20.6	1.38707
2017-06-16	20.45	1.38324
2017-06-15	20.41	1.38378
2017-06-14	20.59	1.37595
2017-06-13	20.78	1.38172
2017-06-12	20.59	1.38424
2017-06-09	20.72	1.38401
2017-06-08	20.47	1.3827
2017-06-07	20.43	1.38187
2017-06-06	20.49	1.37925
2017-06-05	20.49	1.38157
2017-06-02	20.48	1.38104
2017-06-01	20.65	1.38653
2017-05-31	20.47	1.3832
2017-05-30	20.6	1.3853
2017-05-29	20.84	1.38665
2017-05-26	20.8	1.38071
2017-05-25	21.04	1.38634
2017-05-24	21	1.38451
2017-05-23	21	1.38995
2017-05-22	20.86	1.38642
2017-05-19	20.7	1.38523
2017-05-18	20.63	1.39297
2017-05-17	20.8	1.38981
2017-05-16	20.65	1.39474
2017-05-15	20.77	1.39749
2017-05-12	20.68	1.40394
2017-05-11	20.93	1.40746
2017-05-09	20.5	1.41128
2017-05-08	20.3	1.40604
2017-05-05	20.42	1.40496
2017-05-04	20.45	1.40069
2017-05-03	20.53	1.39724
2017-05-02	19.57	1.39379
2017-04-28	19.07	1.39739
2017-04-27	18.93	1.3971
2017-04-26	19.03	1.39598
2017-04-25	18.92	1.39412
2017-04-24	18.73	1.39261
2017-04-21	18.5	1.39655
2017-04-20	18.64	1.39772
2017-04-19	18.52	1.39821
2017-04-18	18.65	1.39584
2017-04-17	18.63	1.39794
2017-04-13	18.82	1.39799
2017-04-12	18.97	1.39653
2017-04-11	18.88	1.40404
2017-04-10	18.85	1.4048
2017-04-07	18.78	1.40474
2017-04-06	18.85	1.40211
2017-04-05	18.93	1.40067
2017-04-04	18.95	1.39817
2017-04-03	19.12	1.3971
2017-03-31	19.12	1.39639
2017-03-30	19.02	1.39769
2017-03-29	19.01	1.39407
2017-03-28	18.75	1.39677
2017-03-27	18.43	1.39397
2017-03-24	18.52	1.39885
2017-03-23	18.38	1.3997
2017-03-22	18.4	1.39854
2017-03-21	18.73	1.39934
2017-03-20	18.74	1.39688
2017-03-17	18.86	1.40201
2017-03-16	18.84	1.40121
2017-03-15	18.85	1.40224
2017-03-14	18.91	1.41592
2017-03-13	18.83	1.41477
2017-03-10	18.66	1.41173
2017-03-09	18.67	1.42132
2017-03-08	19	1.41763
2017-03-07	18.82	1.41135
2017-03-06	18.79	1.41235
2017-03-03	18.74	1.41037
2017-03-02	18.76	1.41213
2017-03-01	18.55	1.40907
2017-02-28	18.46	1.405
2017-02-27	18.54	1.40429
2017-02-24	18.6	1.40447
2017-02-23	18.62	1.40763
2017-02-22	18.48	1.41323
2017-02-21	18.19	1.42045
2017-02-20	18.23	1.41793
2017-02-17	18.33	1.41901
2017-02-16	18.27	1.41659
2017-02-15	17.97	1.41906
2017-02-14	18	1.41995
2017-02-13	18.64	1.42416
2017-02-10	18.7	1.42058
2017-02-09	18.55	1.42066
2017-02-08	18.53	1.41667
2017-02-07	18.59	1.41857
2017-02-06	18.66	1.40917
2017-02-03	18.39	1.40746
2017-02-02	18.51	1.41138
2017-02-01	18.61	1.41244
2017-01-31	18.7	1.40954
2017-01-27	18.89	1.43178
2017-01-26	18.76	1.42589
2017-01-25	18.58	1.41285
2017-01-24	18.39	1.42117
2017-01-23	18.08	1.41598
2017-01-20	18.01	1.42705
2017-01-19	18.02	1.42616
2017-01-18	17.94	1.42876
2017-01-17	18.09	1.41601
2017-01-16	18.06	1.4303
2017-01-13	18.05	1.42592
2017-01-12	17.86	1.42728
2017-01-11	17.78	1.42678
2017-01-10	17.73	1.43654
2017-01-09	17.59	1.43529
2017-01-06	17.42	1.43938
2017-01-05	17.54	1.42847
2017-01-04	17.27	1.43942
2017-01-03	17.07	1.44992
2016-12-30	17.09	1.44655
2016-12-29	17.13	1.44814
2016-12-28	17.22	1.45018
2016-12-27	17.19	1.44954
2016-12-23	17.14	1.44766
"

d<-read.delim(textConnection(datatext),header=TRUE,sep="",strip.white=TRUE)

# Order 1 Polynomial Model
# model_1
# You place the order-1 polynomial model in variable model_1
m1=lm(formula = d$DBS ~ d$SGD)
summary(m1)
plot(d$SGD, d$DBS, main = 'Regressions on DBS Share Prediction Data', xlab = 'S$ vs US$', ylab = 'DBS Share Price')
abline(m1, col="red")


# Order 2 Polynomial Model
# model_2
# You place the order-2 polynomial model in variable model_2
d$SGD2 = d$SGD ^ 2
m2=lm(formula = d$DBS ~ d$SGD + d$SGD2)
summary(m2)

predict.m1 <- predict(m1, newdata = d)
error1 <- d$DBS - predict.m1

# Testset Errors
RMSE.m1 <- sqrt(mean(error1^2))
RMSE.m1

predict.m2 <- predict(m2, newdata = d)
error2 <- d$DBS - predict.m2

# Testset Errors
RMSE.m2 <- sqrt(mean(error2^2))
RMSE.m2



